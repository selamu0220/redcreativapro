"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
exports.id = "_ssr_src_lib_ai_ts";
exports.ids = ["_ssr_src_lib_ai_ts"];
exports.modules = {

/***/ "(ssr)/./src/lib/ai.ts":
/*!***********************!*\
  !*** ./src/lib/ai.ts ***!
  \***********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   enhanceSearchWithAI: () => (/* binding */ enhanceSearchWithAI),\n/* harmony export */   generateScriptWithAI: () => (/* binding */ generateScriptWithAI)\n/* harmony export */ });\nasync function generateScriptWithAI(prompt, provider, apiKey, model, temperature, maxTokens, baseUrl) {\n    // Get stored AI settings if not provided\n    if (!apiKey || !provider) {\n        const storedSettings = localStorage.getItem('aiSettings');\n        if (storedSettings) {\n            const settings = JSON.parse(storedSettings);\n            provider = provider || settings.provider;\n            apiKey = apiKey || settings.apiKey;\n            model = model || settings.model;\n            temperature = temperature ?? settings.temperature;\n            maxTokens = maxTokens ?? settings.maxTokens;\n            baseUrl = baseUrl || settings.baseUrl;\n        }\n    }\n    if (!provider) {\n        throw new Error('Se requiere seleccionar un proveedor de IA. Por favor configura tus ajustes de IA en el menú de usuario.');\n    }\n    if (!apiKey) {\n        throw new Error('Se requiere una API key. Por favor configura tus ajustes de IA en el menú de usuario.');\n    }\n    // Validate API key format before making request\n    if (typeof apiKey !== 'string' || !apiKey.trim()) {\n        localStorage.removeItem('aiSettings'); // Clear invalid settings\n        throw new Error('API key inválida. Por favor verifica que hayas ingresado una API key válida en los ajustes de usuario.');\n    }\n    // Trim the API key to prevent whitespace issues\n    apiKey = apiKey.trim();\n    try {\n        switch(provider){\n            case 'gemini':\n                {\n                    // Default to gemini-2.0-flash if no model specified\n                    const selectedModel = model || 'gemini-2.0-flash';\n                    const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/${selectedModel}:generateContent?key=${apiKey}`, {\n                        method: 'POST',\n                        headers: {\n                            'Content-Type': 'application/json'\n                        },\n                        body: JSON.stringify({\n                            contents: [\n                                {\n                                    parts: [\n                                        {\n                                            text: prompt\n                                        }\n                                    ]\n                                }\n                            ],\n                            generationConfig: {\n                                temperature: temperature || 0.7,\n                                maxOutputTokens: maxTokens || 2048\n                            }\n                        })\n                    });\n                    if (!response.ok) {\n                        const error = await response.json().catch(()=>({\n                                error: {\n                                    message: 'Error desconocido'\n                                }\n                            }));\n                        if (response.status === 401) {\n                            localStorage.removeItem('aiSettings'); // Clear invalid settings\n                            throw new Error(`La API key de Google AI Studio no es válida para el modelo ${selectedModel}. Por favor, verifica que la API key tenga los permisos necesarios.`);\n                        }\n                        throw new Error(`Error de Gemini: ${error.error?.message || 'No se pudo generar el contenido'}`);\n                    }\n                    const data = await response.json();\n                    if (!data.candidates?.[0]?.content?.parts?.[0]?.text) {\n                        throw new Error('No se recibió una respuesta válida del servicio de IA');\n                    }\n                    return data.candidates[0].content.parts[0].text;\n                }\n            case 'openai':\n                {\n                    const selectedModel = model || 'gpt-4o';\n                    const openaiResponse = await fetch('https://api.openai.com/v1/chat/completions', {\n                        method: 'POST',\n                        headers: {\n                            'Content-Type': 'application/json',\n                            'Authorization': `Bearer ${apiKey}`\n                        },\n                        body: JSON.stringify({\n                            model: selectedModel,\n                            messages: [\n                                {\n                                    role: 'user',\n                                    content: prompt\n                                }\n                            ],\n                            temperature: temperature || 0.7,\n                            max_tokens: maxTokens || 2048\n                        })\n                    });\n                    if (!openaiResponse.ok) {\n                        const error = await openaiResponse.json().catch(()=>({\n                                error: {\n                                    message: 'Error desconocido'\n                                }\n                            }));\n                        if (openaiResponse.status === 401) {\n                            localStorage.removeItem('aiSettings');\n                            throw new Error('API key inválida. Por favor verifica tu API key de OpenAI en los ajustes de usuario.');\n                        }\n                        throw new Error(`Error de OpenAI: ${error.error?.message || 'No se pudo generar el contenido'}`);\n                    }\n                    const openaiData = await openaiResponse.json();\n                    return openaiData.choices[0].message.content;\n                }\n            case 'anthropic':\n                {\n                    const selectedModel = model || 'claude-3-5-sonnet-20241022';\n                    const anthropicResponse = await fetch('https://api.anthropic.com/v1/messages', {\n                        method: 'POST',\n                        headers: {\n                            'Content-Type': 'application/json',\n                            'x-api-key': apiKey,\n                            'anthropic-version': '2023-06-01'\n                        },\n                        body: JSON.stringify({\n                            model: selectedModel,\n                            messages: [\n                                {\n                                    role: 'user',\n                                    content: prompt\n                                }\n                            ],\n                            max_tokens: maxTokens || 2048,\n                            temperature: temperature || 0.7\n                        })\n                    });\n                    if (!anthropicResponse.ok) {\n                        const error = await anthropicResponse.json().catch(()=>({\n                                error: {\n                                    message: 'Error desconocido'\n                                }\n                            }));\n                        if (anthropicResponse.status === 401) {\n                            localStorage.removeItem('aiSettings');\n                            throw new Error('API key inválida. Por favor verifica tu API key de Anthropic en los ajustes de usuario.');\n                        }\n                        throw new Error(`Error de Anthropic: ${error.error?.message || 'No se pudo generar el contenido'}`);\n                    }\n                    const anthropicData = await anthropicResponse.json();\n                    return anthropicData.content[0].text;\n                }\n            case 'cohere':\n                {\n                    const selectedModel = model || 'command-r-plus';\n                    const apiUrl = baseUrl || 'https://api.cohere.ai/v1/generate';\n                    const cohereResponse = await fetch(apiUrl, {\n                        method: 'POST',\n                        headers: {\n                            'Content-Type': 'application/json',\n                            'Authorization': `Bearer ${apiKey}`\n                        },\n                        body: JSON.stringify({\n                            model: selectedModel,\n                            prompt: prompt,\n                            max_tokens: maxTokens || 2048,\n                            temperature: temperature || 0.7\n                        })\n                    });\n                    if (!cohereResponse.ok) {\n                        const error = await cohereResponse.json().catch(()=>({\n                                message: 'Error desconocido'\n                            }));\n                        if (cohereResponse.status === 401) {\n                            localStorage.removeItem('aiSettings');\n                            throw new Error('API key inválida. Por favor verifica tu API key de Cohere en los ajustes de usuario.');\n                        }\n                        throw new Error(`Error de Cohere: ${error.message || 'No se pudo generar el contenido'}`);\n                    }\n                    const cohereData = await cohereResponse.json();\n                    return cohereData.generations[0].text;\n                }\n            case 'mistral':\n                {\n                    const selectedModel = model || 'mistral-large-latest';\n                    const apiUrl = baseUrl || 'https://api.mistral.ai/v1/chat/completions';\n                    const mistralResponse = await fetch(apiUrl, {\n                        method: 'POST',\n                        headers: {\n                            'Content-Type': 'application/json',\n                            'Authorization': `Bearer ${apiKey}`\n                        },\n                        body: JSON.stringify({\n                            model: selectedModel,\n                            messages: [\n                                {\n                                    role: 'user',\n                                    content: prompt\n                                }\n                            ],\n                            max_tokens: maxTokens || 2048,\n                            temperature: temperature || 0.7\n                        })\n                    });\n                    if (!mistralResponse.ok) {\n                        const error = await mistralResponse.json().catch(()=>({\n                                error: {\n                                    message: 'Error desconocido'\n                                }\n                            }));\n                        if (mistralResponse.status === 401) {\n                            localStorage.removeItem('aiSettings');\n                            throw new Error('API key inválida. Por favor verifica tu API key de Mistral en los ajustes de usuario.');\n                        }\n                        throw new Error(`Error de Mistral: ${error.error?.message || 'No se pudo generar el contenido'}`);\n                    }\n                    const mistralData = await mistralResponse.json();\n                    return mistralData.choices[0].message.content;\n                }\n            default:\n                throw new Error('Proveedor de IA no soportado');\n        }\n    } catch (error) {\n        console.error('Error en generateScriptWithAI:', error);\n        if (error.message.includes('API key')) {\n            throw error;\n        }\n        throw new Error(`Error al conectar con el servicio de IA: ${error.message}. Por favor verifica tu API key e inténtalo de nuevo.`);\n    }\n}\nasync function enhanceSearchWithAI(query) {\n    try {\n        const storedSettings = localStorage.getItem('aiSettings');\n        if (!storedSettings) {\n            throw new Error('Para obtener sugerencias de IA, configura tus ajustes en el menú de usuario (ícono de perfil → Ajustes)');\n        }\n        const settings = JSON.parse(storedSettings);\n        const { provider, apiKey, model } = settings;\n        if (!provider || !apiKey) {\n            throw new Error('Para obtener sugerencias de IA, configura el proveedor y API key en el menú de usuario (ícono de perfil → Ajustes)');\n        }\n        const prompt = `Analiza esta búsqueda: \"${query}\"\n    1. Extrae conceptos clave y términos relacionados\n    2. Identifica sinónimos y temas relacionados\n    3. Devuelve una lista de términos relevantes para la búsqueda\n    Formato: lista de términos separados por comas, máximo 5 términos.\n    Respuesta en español.`;\n        const response = await generateScriptWithAI(prompt, provider, apiKey, model);\n        const terms = response.split(',').map((term)=>term.trim()).filter(Boolean).slice(0, 5);\n        if (terms.length === 0) {\n            throw new Error('No se pudieron generar sugerencias para esta búsqueda');\n        }\n        return terms;\n    } catch (error) {\n        console.error('Error al mejorar la búsqueda:', error);\n        throw error;\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9zcmMvbGliL2FpLnRzIiwibWFwcGluZ3MiOiI7Ozs7O0FBSU8sZUFBZUEscUJBQ3BCQyxNQUFjLEVBQ2RDLFFBQXFCLEVBQ3JCQyxNQUFlLEVBQ2ZDLEtBQWUsRUFDZkMsV0FBb0IsRUFDcEJDLFNBQWtCLEVBQ2xCQyxPQUFnQjtJQUdoQix5Q0FBeUM7SUFDekMsSUFBSSxDQUFDSixVQUFVLENBQUNELFVBQVU7UUFDeEIsTUFBTU0saUJBQWlCQyxhQUFhQyxPQUFPLENBQUM7UUFDNUMsSUFBSUYsZ0JBQWdCO1lBQ2xCLE1BQU1HLFdBQXVCQyxLQUFLQyxLQUFLLENBQUNMO1lBQ3hDTixXQUFXQSxZQUFZUyxTQUFTVCxRQUFRO1lBQ3hDQyxTQUFTQSxVQUFVUSxTQUFTUixNQUFNO1lBQ2xDQyxRQUFRQSxTQUFTTyxTQUFTUCxLQUFLO1lBQy9CQyxjQUFjQSxlQUFlTSxTQUFTTixXQUFXO1lBQ2pEQyxZQUFZQSxhQUFhSyxTQUFTTCxTQUFTO1lBQzNDQyxVQUFVQSxXQUFXSSxTQUFTSixPQUFPO1FBQ3ZDO0lBQ0Y7SUFFQSxJQUFJLENBQUNMLFVBQVU7UUFDYixNQUFNLElBQUlZLE1BQU07SUFDbEI7SUFFQSxJQUFJLENBQUNYLFFBQVE7UUFDWCxNQUFNLElBQUlXLE1BQU07SUFDbEI7SUFFQSxnREFBZ0Q7SUFDaEQsSUFBSSxPQUFPWCxXQUFXLFlBQVksQ0FBQ0EsT0FBT1ksSUFBSSxJQUFJO1FBQ2hETixhQUFhTyxVQUFVLENBQUMsZUFBZSx5QkFBeUI7UUFDaEUsTUFBTSxJQUFJRixNQUFNO0lBQ2xCO0lBRUEsZ0RBQWdEO0lBQ2hEWCxTQUFTQSxPQUFPWSxJQUFJO0lBRXBCLElBQUk7UUFDRixPQUFRYjtZQUNOLEtBQUs7Z0JBQVU7b0JBQ2Isb0RBQW9EO29CQUNwRCxNQUFNZSxnQkFBZ0JiLFNBQVM7b0JBRS9CLE1BQU1jLFdBQVcsTUFBTUMsTUFBTSxDQUFDLHdEQUF3RCxFQUFFRixjQUFjLHFCQUFxQixFQUFFZCxRQUFRLEVBQUU7d0JBQ3JJaUIsUUFBUTt3QkFDUkMsU0FBUzs0QkFDUCxnQkFBZ0I7d0JBQ2xCO3dCQUNBQyxNQUFNVixLQUFLVyxTQUFTLENBQUM7NEJBQ25CQyxVQUFVO2dDQUNSO29DQUNFQyxPQUFPO3dDQUNMOzRDQUNFQyxNQUFNekI7d0NBQ1I7cUNBQ0Q7Z0NBQ0g7NkJBQ0Q7NEJBQ0QwQixrQkFBa0I7Z0NBQ2hCdEIsYUFBYUEsZUFBZTtnQ0FDNUJ1QixpQkFBaUJ0QixhQUFhOzRCQUNoQzt3QkFDRjtvQkFDRjtvQkFFQSxJQUFJLENBQUNZLFNBQVNXLEVBQUUsRUFBRTt3QkFDaEIsTUFBTUMsUUFBUSxNQUFNWixTQUFTYSxJQUFJLEdBQUdDLEtBQUssQ0FBQyxJQUFPO2dDQUFFRixPQUFPO29DQUFFRyxTQUFTO2dDQUFvQjs0QkFBRTt3QkFDM0YsSUFBSWYsU0FBU2dCLE1BQU0sS0FBSyxLQUFLOzRCQUMzQnpCLGFBQWFPLFVBQVUsQ0FBQyxlQUFlLHlCQUF5Qjs0QkFDaEUsTUFBTSxJQUFJRixNQUFNLENBQUMsMkRBQTJELEVBQUVHLGNBQWMsbUVBQW1FLENBQUM7d0JBQ2xLO3dCQUNBLE1BQU0sSUFBSUgsTUFBTSxDQUFDLGlCQUFpQixFQUFFZ0IsTUFBTUEsS0FBSyxFQUFFRyxXQUFXLG1DQUFtQztvQkFDakc7b0JBRUEsTUFBTUUsT0FBTyxNQUFNakIsU0FBU2EsSUFBSTtvQkFDaEMsSUFBSSxDQUFDSSxLQUFLQyxVQUFVLEVBQUUsQ0FBQyxFQUFFLEVBQUVDLFNBQVNaLE9BQU8sQ0FBQyxFQUFFLEVBQUVDLE1BQU07d0JBQ3BELE1BQU0sSUFBSVosTUFBTTtvQkFDbEI7b0JBQ0EsT0FBT3FCLEtBQUtDLFVBQVUsQ0FBQyxFQUFFLENBQUNDLE9BQU8sQ0FBQ1osS0FBSyxDQUFDLEVBQUUsQ0FBQ0MsSUFBSTtnQkFDakQ7WUFFQSxLQUFLO2dCQUFVO29CQUNiLE1BQU1ULGdCQUFnQmIsU0FBUztvQkFDL0IsTUFBTWtDLGlCQUFpQixNQUFNbkIsTUFBTSw4Q0FBOEM7d0JBQy9FQyxRQUFRO3dCQUNSQyxTQUFTOzRCQUNQLGdCQUFnQjs0QkFDaEIsaUJBQWlCLENBQUMsT0FBTyxFQUFFbEIsUUFBUTt3QkFDckM7d0JBQ0FtQixNQUFNVixLQUFLVyxTQUFTLENBQUM7NEJBQ25CbkIsT0FBT2E7NEJBQ1BzQixVQUFVO2dDQUFDO29DQUFFQyxNQUFNO29DQUFRSCxTQUFTcEM7Z0NBQU87NkJBQUU7NEJBQzdDSSxhQUFhQSxlQUFlOzRCQUM1Qm9DLFlBQVluQyxhQUFhO3dCQUMzQjtvQkFDRjtvQkFFQSxJQUFJLENBQUNnQyxlQUFlVCxFQUFFLEVBQUU7d0JBQ3RCLE1BQU1DLFFBQVEsTUFBTVEsZUFBZVAsSUFBSSxHQUFHQyxLQUFLLENBQUMsSUFBTztnQ0FBRUYsT0FBTztvQ0FBRUcsU0FBUztnQ0FBb0I7NEJBQUU7d0JBQ2pHLElBQUlLLGVBQWVKLE1BQU0sS0FBSyxLQUFLOzRCQUNqQ3pCLGFBQWFPLFVBQVUsQ0FBQzs0QkFDeEIsTUFBTSxJQUFJRixNQUFNO3dCQUNsQjt3QkFDQSxNQUFNLElBQUlBLE1BQU0sQ0FBQyxpQkFBaUIsRUFBRWdCLE1BQU1BLEtBQUssRUFBRUcsV0FBVyxtQ0FBbUM7b0JBQ2pHO29CQUVBLE1BQU1TLGFBQWEsTUFBTUosZUFBZVAsSUFBSTtvQkFDNUMsT0FBT1csV0FBV0MsT0FBTyxDQUFDLEVBQUUsQ0FBQ1YsT0FBTyxDQUFDSSxPQUFPO2dCQUM5QztZQUVBLEtBQUs7Z0JBQWE7b0JBQ2hCLE1BQU1wQixnQkFBZ0JiLFNBQVM7b0JBQy9CLE1BQU13QyxvQkFBb0IsTUFBTXpCLE1BQU0seUNBQXlDO3dCQUM3RUMsUUFBUTt3QkFDUkMsU0FBUzs0QkFDUCxnQkFBZ0I7NEJBQ2hCLGFBQWFsQjs0QkFDYixxQkFBcUI7d0JBQ3ZCO3dCQUNBbUIsTUFBTVYsS0FBS1csU0FBUyxDQUFDOzRCQUNuQm5CLE9BQU9hOzRCQUNQc0IsVUFBVTtnQ0FBQztvQ0FBRUMsTUFBTTtvQ0FBUUgsU0FBU3BDO2dDQUFPOzZCQUFFOzRCQUM3Q3dDLFlBQVluQyxhQUFhOzRCQUN6QkQsYUFBYUEsZUFBZTt3QkFDOUI7b0JBQ0Y7b0JBRUEsSUFBSSxDQUFDdUMsa0JBQWtCZixFQUFFLEVBQUU7d0JBQ3pCLE1BQU1DLFFBQVEsTUFBTWMsa0JBQWtCYixJQUFJLEdBQUdDLEtBQUssQ0FBQyxJQUFPO2dDQUFFRixPQUFPO29DQUFFRyxTQUFTO2dDQUFvQjs0QkFBRTt3QkFDcEcsSUFBSVcsa0JBQWtCVixNQUFNLEtBQUssS0FBSzs0QkFDcEN6QixhQUFhTyxVQUFVLENBQUM7NEJBQ3hCLE1BQU0sSUFBSUYsTUFBTTt3QkFDbEI7d0JBQ0EsTUFBTSxJQUFJQSxNQUFNLENBQUMsb0JBQW9CLEVBQUVnQixNQUFNQSxLQUFLLEVBQUVHLFdBQVcsbUNBQW1DO29CQUNwRztvQkFFQSxNQUFNWSxnQkFBZ0IsTUFBTUQsa0JBQWtCYixJQUFJO29CQUNsRCxPQUFPYyxjQUFjUixPQUFPLENBQUMsRUFBRSxDQUFDWCxJQUFJO2dCQUN0QztZQUVBLEtBQUs7Z0JBQVU7b0JBQ2IsTUFBTVQsZ0JBQWdCYixTQUFTO29CQUMvQixNQUFNMEMsU0FBU3ZDLFdBQVc7b0JBRTFCLE1BQU13QyxpQkFBaUIsTUFBTTVCLE1BQU0yQixRQUFRO3dCQUN6QzFCLFFBQVE7d0JBQ1JDLFNBQVM7NEJBQ1AsZ0JBQWdCOzRCQUNoQixpQkFBaUIsQ0FBQyxPQUFPLEVBQUVsQixRQUFRO3dCQUNyQzt3QkFDQW1CLE1BQU1WLEtBQUtXLFNBQVMsQ0FBQzs0QkFDbkJuQixPQUFPYTs0QkFDUGhCLFFBQVFBOzRCQUNSd0MsWUFBWW5DLGFBQWE7NEJBQ3pCRCxhQUFhQSxlQUFlO3dCQUM5QjtvQkFDRjtvQkFFQSxJQUFJLENBQUMwQyxlQUFlbEIsRUFBRSxFQUFFO3dCQUN0QixNQUFNQyxRQUFRLE1BQU1pQixlQUFlaEIsSUFBSSxHQUFHQyxLQUFLLENBQUMsSUFBTztnQ0FBRUMsU0FBUzs0QkFBb0I7d0JBQ3RGLElBQUljLGVBQWViLE1BQU0sS0FBSyxLQUFLOzRCQUNqQ3pCLGFBQWFPLFVBQVUsQ0FBQzs0QkFDeEIsTUFBTSxJQUFJRixNQUFNO3dCQUNsQjt3QkFDQSxNQUFNLElBQUlBLE1BQU0sQ0FBQyxpQkFBaUIsRUFBRWdCLE1BQU1HLE9BQU8sSUFBSSxtQ0FBbUM7b0JBQzFGO29CQUVBLE1BQU1lLGFBQWEsTUFBTUQsZUFBZWhCLElBQUk7b0JBQzVDLE9BQU9pQixXQUFXQyxXQUFXLENBQUMsRUFBRSxDQUFDdkIsSUFBSTtnQkFDdkM7WUFFQSxLQUFLO2dCQUFXO29CQUNkLE1BQU1ULGdCQUFnQmIsU0FBUztvQkFDL0IsTUFBTTBDLFNBQVN2QyxXQUFXO29CQUUxQixNQUFNMkMsa0JBQWtCLE1BQU0vQixNQUFNMkIsUUFBUTt3QkFDMUMxQixRQUFRO3dCQUNSQyxTQUFTOzRCQUNQLGdCQUFnQjs0QkFDaEIsaUJBQWlCLENBQUMsT0FBTyxFQUFFbEIsUUFBUTt3QkFDckM7d0JBQ0FtQixNQUFNVixLQUFLVyxTQUFTLENBQUM7NEJBQ25CbkIsT0FBT2E7NEJBQ1BzQixVQUFVO2dDQUFDO29DQUFFQyxNQUFNO29DQUFRSCxTQUFTcEM7Z0NBQU87NkJBQUU7NEJBQzdDd0MsWUFBWW5DLGFBQWE7NEJBQ3pCRCxhQUFhQSxlQUFlO3dCQUM5QjtvQkFDRjtvQkFFQSxJQUFJLENBQUM2QyxnQkFBZ0JyQixFQUFFLEVBQUU7d0JBQ3ZCLE1BQU1DLFFBQVEsTUFBTW9CLGdCQUFnQm5CLElBQUksR0FBR0MsS0FBSyxDQUFDLElBQU87Z0NBQUVGLE9BQU87b0NBQUVHLFNBQVM7Z0NBQW9COzRCQUFFO3dCQUNsRyxJQUFJaUIsZ0JBQWdCaEIsTUFBTSxLQUFLLEtBQUs7NEJBQ2xDekIsYUFBYU8sVUFBVSxDQUFDOzRCQUN4QixNQUFNLElBQUlGLE1BQU07d0JBQ2xCO3dCQUNBLE1BQU0sSUFBSUEsTUFBTSxDQUFDLGtCQUFrQixFQUFFZ0IsTUFBTUEsS0FBSyxFQUFFRyxXQUFXLG1DQUFtQztvQkFDbEc7b0JBRUEsTUFBTWtCLGNBQWMsTUFBTUQsZ0JBQWdCbkIsSUFBSTtvQkFDOUMsT0FBT29CLFlBQVlSLE9BQU8sQ0FBQyxFQUFFLENBQUNWLE9BQU8sQ0FBQ0ksT0FBTztnQkFDL0M7WUFFQTtnQkFDRSxNQUFNLElBQUl2QixNQUFNO1FBQ3BCO0lBQ0YsRUFBRSxPQUFPZ0IsT0FBWTtRQUNuQnNCLFFBQVF0QixLQUFLLENBQUMsa0NBQWtDQTtRQUNoRCxJQUFJQSxNQUFNRyxPQUFPLENBQUNvQixRQUFRLENBQUMsWUFBWTtZQUNyQyxNQUFNdkI7UUFDUjtRQUNBLE1BQU0sSUFBSWhCLE1BQU0sQ0FBQyx5Q0FBeUMsRUFBRWdCLE1BQU1HLE9BQU8sQ0FBQyxxREFBcUQsQ0FBQztJQUNsSTtBQUNGO0FBRU8sZUFBZXFCLG9CQUFvQkMsS0FBYTtJQUNyRCxJQUFJO1FBQ0YsTUFBTS9DLGlCQUFpQkMsYUFBYUMsT0FBTyxDQUFDO1FBQzVDLElBQUksQ0FBQ0YsZ0JBQWdCO1lBQ25CLE1BQU0sSUFBSU0sTUFBTTtRQUNsQjtRQUVBLE1BQU1ILFdBQVdDLEtBQUtDLEtBQUssQ0FBQ0w7UUFDNUIsTUFBTSxFQUFFTixRQUFRLEVBQUVDLE1BQU0sRUFBRUMsS0FBSyxFQUFFLEdBQUdPO1FBRXBDLElBQUksQ0FBQ1QsWUFBWSxDQUFDQyxRQUFRO1lBQ3hCLE1BQU0sSUFBSVcsTUFBTTtRQUNsQjtRQUVBLE1BQU1iLFNBQVMsQ0FBQyx3QkFBd0IsRUFBRXNELE1BQU07Ozs7O3lCQUszQixDQUFDO1FBRXRCLE1BQU1yQyxXQUFXLE1BQU1sQixxQkFBcUJDLFFBQVFDLFVBQVVDLFFBQVFDO1FBQ3RFLE1BQU1vRCxRQUFRdEMsU0FBU3VDLEtBQUssQ0FBQyxLQUMxQkMsR0FBRyxDQUFDQyxDQUFBQSxPQUFRQSxLQUFLNUMsSUFBSSxJQUNyQjZDLE1BQU0sQ0FBQ0MsU0FDUEMsS0FBSyxDQUFDLEdBQUc7UUFFWixJQUFJTixNQUFNTyxNQUFNLEtBQUssR0FBRztZQUN0QixNQUFNLElBQUlqRCxNQUFNO1FBQ2xCO1FBRUEsT0FBTzBDO0lBQ1QsRUFBRSxPQUFPMUIsT0FBWTtRQUNuQnNCLFFBQVF0QixLQUFLLENBQUMsaUNBQWlDQTtRQUMvQyxNQUFNQTtJQUNSO0FBQ0YiLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xccHJvZ3JhbWFyXFxEb2N1bWVudHNcXEdpdEh1YlxccmVkY3JlYXRpdmFwcm9cXHNyY1xcbGliXFxhaS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBBSVByb3ZpZGVyLCBBSU1vZGVsLCBBSVNldHRpbmdzIH0gZnJvbSAnQC90eXBlcy9haSc7XHJcblxyXG5cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZW5lcmF0ZVNjcmlwdFdpdGhBSShcclxuICBwcm9tcHQ6IHN0cmluZywgXHJcbiAgcHJvdmlkZXI/OiBBSVByb3ZpZGVyLCBcclxuICBhcGlLZXk/OiBzdHJpbmcsXHJcbiAgbW9kZWw/OiBBSU1vZGVsLFxyXG4gIHRlbXBlcmF0dXJlPzogbnVtYmVyLFxyXG4gIG1heFRva2Vucz86IG51bWJlcixcclxuICBiYXNlVXJsPzogc3RyaW5nXHJcbik6IFByb21pc2U8c3RyaW5nPiB7XHJcbiAgXHJcbiAgLy8gR2V0IHN0b3JlZCBBSSBzZXR0aW5ncyBpZiBub3QgcHJvdmlkZWRcclxuICBpZiAoIWFwaUtleSB8fCAhcHJvdmlkZXIpIHtcclxuICAgIGNvbnN0IHN0b3JlZFNldHRpbmdzID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ2FpU2V0dGluZ3MnKTtcclxuICAgIGlmIChzdG9yZWRTZXR0aW5ncykge1xyXG4gICAgICBjb25zdCBzZXR0aW5nczogQUlTZXR0aW5ncyA9IEpTT04ucGFyc2Uoc3RvcmVkU2V0dGluZ3MpO1xyXG4gICAgICBwcm92aWRlciA9IHByb3ZpZGVyIHx8IHNldHRpbmdzLnByb3ZpZGVyO1xyXG4gICAgICBhcGlLZXkgPSBhcGlLZXkgfHwgc2V0dGluZ3MuYXBpS2V5O1xyXG4gICAgICBtb2RlbCA9IG1vZGVsIHx8IHNldHRpbmdzLm1vZGVsO1xyXG4gICAgICB0ZW1wZXJhdHVyZSA9IHRlbXBlcmF0dXJlID8/IHNldHRpbmdzLnRlbXBlcmF0dXJlO1xyXG4gICAgICBtYXhUb2tlbnMgPSBtYXhUb2tlbnMgPz8gc2V0dGluZ3MubWF4VG9rZW5zO1xyXG4gICAgICBiYXNlVXJsID0gYmFzZVVybCB8fCBzZXR0aW5ncy5iYXNlVXJsO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgaWYgKCFwcm92aWRlcikge1xyXG4gICAgdGhyb3cgbmV3IEVycm9yKCdTZSByZXF1aWVyZSBzZWxlY2Npb25hciB1biBwcm92ZWVkb3IgZGUgSUEuIFBvciBmYXZvciBjb25maWd1cmEgdHVzIGFqdXN0ZXMgZGUgSUEgZW4gZWwgbWVuw7ogZGUgdXN1YXJpby4nKTtcclxuICB9XHJcblxyXG4gIGlmICghYXBpS2V5KSB7XHJcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ1NlIHJlcXVpZXJlIHVuYSBBUEkga2V5LiBQb3IgZmF2b3IgY29uZmlndXJhIHR1cyBhanVzdGVzIGRlIElBIGVuIGVsIG1lbsO6IGRlIHVzdWFyaW8uJyk7XHJcbiAgfVxyXG5cclxuICAvLyBWYWxpZGF0ZSBBUEkga2V5IGZvcm1hdCBiZWZvcmUgbWFraW5nIHJlcXVlc3RcclxuICBpZiAodHlwZW9mIGFwaUtleSAhPT0gJ3N0cmluZycgfHwgIWFwaUtleS50cmltKCkpIHtcclxuICAgIGxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKCdhaVNldHRpbmdzJyk7IC8vIENsZWFyIGludmFsaWQgc2V0dGluZ3NcclxuICAgIHRocm93IG5ldyBFcnJvcignQVBJIGtleSBpbnbDoWxpZGEuIFBvciBmYXZvciB2ZXJpZmljYSBxdWUgaGF5YXMgaW5ncmVzYWRvIHVuYSBBUEkga2V5IHbDoWxpZGEgZW4gbG9zIGFqdXN0ZXMgZGUgdXN1YXJpby4nKTtcclxuICB9XHJcblxyXG4gIC8vIFRyaW0gdGhlIEFQSSBrZXkgdG8gcHJldmVudCB3aGl0ZXNwYWNlIGlzc3Vlc1xyXG4gIGFwaUtleSA9IGFwaUtleS50cmltKCk7XHJcblxyXG4gIHRyeSB7XHJcbiAgICBzd2l0Y2ggKHByb3ZpZGVyKSB7XHJcbiAgICAgIGNhc2UgJ2dlbWluaSc6IHtcclxuICAgICAgICAvLyBEZWZhdWx0IHRvIGdlbWluaS0yLjAtZmxhc2ggaWYgbm8gbW9kZWwgc3BlY2lmaWVkXHJcbiAgICAgICAgY29uc3Qgc2VsZWN0ZWRNb2RlbCA9IG1vZGVsIHx8ICdnZW1pbmktMi4wLWZsYXNoJztcclxuICAgICAgICBcclxuICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKGBodHRwczovL2dlbmVyYXRpdmVsYW5ndWFnZS5nb29nbGVhcGlzLmNvbS92MWJldGEvbW9kZWxzLyR7c2VsZWN0ZWRNb2RlbH06Z2VuZXJhdGVDb250ZW50P2tleT0ke2FwaUtleX1gLCB7XHJcbiAgICAgICAgICBtZXRob2Q6ICdQT1NUJyxcclxuICAgICAgICAgIGhlYWRlcnM6IHtcclxuICAgICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJ1xyXG4gICAgICAgICAgfSxcclxuICAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICAgICAgY29udGVudHM6IFtcclxuICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBwYXJ0czogW1xyXG4gICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGV4dDogcHJvbXB0XHJcbiAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIF1cclxuICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIF0sXHJcbiAgICAgICAgICAgIGdlbmVyYXRpb25Db25maWc6IHtcclxuICAgICAgICAgICAgICB0ZW1wZXJhdHVyZTogdGVtcGVyYXR1cmUgfHwgMC43LFxyXG4gICAgICAgICAgICAgIG1heE91dHB1dFRva2VuczogbWF4VG9rZW5zIHx8IDIwNDhcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfSlcclxuICAgICAgICB9KTtcclxuICAgICAgICBcclxuICAgICAgICBpZiAoIXJlc3BvbnNlLm9rKSB7XHJcbiAgICAgICAgICBjb25zdCBlcnJvciA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKS5jYXRjaCgoKSA9PiAoeyBlcnJvcjogeyBtZXNzYWdlOiAnRXJyb3IgZGVzY29ub2NpZG8nIH0gfSkpO1xyXG4gICAgICAgICAgaWYgKHJlc3BvbnNlLnN0YXR1cyA9PT0gNDAxKSB7XHJcbiAgICAgICAgICAgIGxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKCdhaVNldHRpbmdzJyk7IC8vIENsZWFyIGludmFsaWQgc2V0dGluZ3NcclxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBMYSBBUEkga2V5IGRlIEdvb2dsZSBBSSBTdHVkaW8gbm8gZXMgdsOhbGlkYSBwYXJhIGVsIG1vZGVsbyAke3NlbGVjdGVkTW9kZWx9LiBQb3IgZmF2b3IsIHZlcmlmaWNhIHF1ZSBsYSBBUEkga2V5IHRlbmdhIGxvcyBwZXJtaXNvcyBuZWNlc2FyaW9zLmApO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBFcnJvciBkZSBHZW1pbmk6ICR7ZXJyb3IuZXJyb3I/Lm1lc3NhZ2UgfHwgJ05vIHNlIHB1ZG8gZ2VuZXJhciBlbCBjb250ZW5pZG8nfWApO1xyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgICAgICBjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xyXG4gICAgICAgIGlmICghZGF0YS5jYW5kaWRhdGVzPy5bMF0/LmNvbnRlbnQ/LnBhcnRzPy5bMF0/LnRleHQpIHtcclxuICAgICAgICAgIHRocm93IG5ldyBFcnJvcignTm8gc2UgcmVjaWJpw7MgdW5hIHJlc3B1ZXN0YSB2w6FsaWRhIGRlbCBzZXJ2aWNpbyBkZSBJQScpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gZGF0YS5jYW5kaWRhdGVzWzBdLmNvbnRlbnQucGFydHNbMF0udGV4dDtcclxuICAgICAgfVxyXG5cclxuICAgICAgY2FzZSAnb3BlbmFpJzoge1xyXG4gICAgICAgIGNvbnN0IHNlbGVjdGVkTW9kZWwgPSBtb2RlbCB8fCAnZ3B0LTRvJztcclxuICAgICAgICBjb25zdCBvcGVuYWlSZXNwb25zZSA9IGF3YWl0IGZldGNoKCdodHRwczovL2FwaS5vcGVuYWkuY29tL3YxL2NoYXQvY29tcGxldGlvbnMnLCB7XHJcbiAgICAgICAgICBtZXRob2Q6ICdQT1NUJyxcclxuICAgICAgICAgIGhlYWRlcnM6IHtcclxuICAgICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyxcclxuICAgICAgICAgICAgJ0F1dGhvcml6YXRpb24nOiBgQmVhcmVyICR7YXBpS2V5fWBcclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgICAgIG1vZGVsOiBzZWxlY3RlZE1vZGVsLFxyXG4gICAgICAgICAgICBtZXNzYWdlczogW3sgcm9sZTogJ3VzZXInLCBjb250ZW50OiBwcm9tcHQgfV0sXHJcbiAgICAgICAgICAgIHRlbXBlcmF0dXJlOiB0ZW1wZXJhdHVyZSB8fCAwLjcsXHJcbiAgICAgICAgICAgIG1heF90b2tlbnM6IG1heFRva2VucyB8fCAyMDQ4XHJcbiAgICAgICAgICB9KVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIFxyXG4gICAgICAgIGlmICghb3BlbmFpUmVzcG9uc2Uub2spIHtcclxuICAgICAgICAgIGNvbnN0IGVycm9yID0gYXdhaXQgb3BlbmFpUmVzcG9uc2UuanNvbigpLmNhdGNoKCgpID0+ICh7IGVycm9yOiB7IG1lc3NhZ2U6ICdFcnJvciBkZXNjb25vY2lkbycgfSB9KSk7XHJcbiAgICAgICAgICBpZiAob3BlbmFpUmVzcG9uc2Uuc3RhdHVzID09PSA0MDEpIHtcclxuICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oJ2FpU2V0dGluZ3MnKTtcclxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdBUEkga2V5IGludsOhbGlkYS4gUG9yIGZhdm9yIHZlcmlmaWNhIHR1IEFQSSBrZXkgZGUgT3BlbkFJIGVuIGxvcyBhanVzdGVzIGRlIHVzdWFyaW8uJyk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEVycm9yIGRlIE9wZW5BSTogJHtlcnJvci5lcnJvcj8ubWVzc2FnZSB8fCAnTm8gc2UgcHVkbyBnZW5lcmFyIGVsIGNvbnRlbmlkbyd9YCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgICAgIGNvbnN0IG9wZW5haURhdGEgPSBhd2FpdCBvcGVuYWlSZXNwb25zZS5qc29uKCk7XHJcbiAgICAgICAgcmV0dXJuIG9wZW5haURhdGEuY2hvaWNlc1swXS5tZXNzYWdlLmNvbnRlbnQ7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGNhc2UgJ2FudGhyb3BpYyc6IHtcclxuICAgICAgICBjb25zdCBzZWxlY3RlZE1vZGVsID0gbW9kZWwgfHwgJ2NsYXVkZS0zLTUtc29ubmV0LTIwMjQxMDIyJztcclxuICAgICAgICBjb25zdCBhbnRocm9waWNSZXNwb25zZSA9IGF3YWl0IGZldGNoKCdodHRwczovL2FwaS5hbnRocm9waWMuY29tL3YxL21lc3NhZ2VzJywge1xyXG4gICAgICAgICAgbWV0aG9kOiAnUE9TVCcsXHJcbiAgICAgICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXHJcbiAgICAgICAgICAgICd4LWFwaS1rZXknOiBhcGlLZXksXHJcbiAgICAgICAgICAgICdhbnRocm9waWMtdmVyc2lvbic6ICcyMDIzLTA2LTAxJ1xyXG4gICAgICAgICAgfSxcclxuICAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICAgICAgbW9kZWw6IHNlbGVjdGVkTW9kZWwsXHJcbiAgICAgICAgICAgIG1lc3NhZ2VzOiBbeyByb2xlOiAndXNlcicsIGNvbnRlbnQ6IHByb21wdCB9XSxcclxuICAgICAgICAgICAgbWF4X3Rva2VuczogbWF4VG9rZW5zIHx8IDIwNDgsXHJcbiAgICAgICAgICAgIHRlbXBlcmF0dXJlOiB0ZW1wZXJhdHVyZSB8fCAwLjdcclxuICAgICAgICAgIH0pXHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgaWYgKCFhbnRocm9waWNSZXNwb25zZS5vaykge1xyXG4gICAgICAgICAgY29uc3QgZXJyb3IgPSBhd2FpdCBhbnRocm9waWNSZXNwb25zZS5qc29uKCkuY2F0Y2goKCkgPT4gKHsgZXJyb3I6IHsgbWVzc2FnZTogJ0Vycm9yIGRlc2Nvbm9jaWRvJyB9IH0pKTtcclxuICAgICAgICAgIGlmIChhbnRocm9waWNSZXNwb25zZS5zdGF0dXMgPT09IDQwMSkge1xyXG4gICAgICAgICAgICBsb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbSgnYWlTZXR0aW5ncycpO1xyXG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0FQSSBrZXkgaW52w6FsaWRhLiBQb3IgZmF2b3IgdmVyaWZpY2EgdHUgQVBJIGtleSBkZSBBbnRocm9waWMgZW4gbG9zIGFqdXN0ZXMgZGUgdXN1YXJpby4nKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgRXJyb3IgZGUgQW50aHJvcGljOiAke2Vycm9yLmVycm9yPy5tZXNzYWdlIHx8ICdObyBzZSBwdWRvIGdlbmVyYXIgZWwgY29udGVuaWRvJ31gKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgY29uc3QgYW50aHJvcGljRGF0YSA9IGF3YWl0IGFudGhyb3BpY1Jlc3BvbnNlLmpzb24oKTtcclxuICAgICAgICByZXR1cm4gYW50aHJvcGljRGF0YS5jb250ZW50WzBdLnRleHQ7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGNhc2UgJ2NvaGVyZSc6IHtcclxuICAgICAgICBjb25zdCBzZWxlY3RlZE1vZGVsID0gbW9kZWwgfHwgJ2NvbW1hbmQtci1wbHVzJztcclxuICAgICAgICBjb25zdCBhcGlVcmwgPSBiYXNlVXJsIHx8ICdodHRwczovL2FwaS5jb2hlcmUuYWkvdjEvZ2VuZXJhdGUnO1xyXG4gICAgICAgIFxyXG4gICAgICAgIGNvbnN0IGNvaGVyZVJlc3BvbnNlID0gYXdhaXQgZmV0Y2goYXBpVXJsLCB7XHJcbiAgICAgICAgICBtZXRob2Q6ICdQT1NUJyxcclxuICAgICAgICAgIGhlYWRlcnM6IHtcclxuICAgICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyxcclxuICAgICAgICAgICAgJ0F1dGhvcml6YXRpb24nOiBgQmVhcmVyICR7YXBpS2V5fWBcclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgICAgIG1vZGVsOiBzZWxlY3RlZE1vZGVsLFxyXG4gICAgICAgICAgICBwcm9tcHQ6IHByb21wdCxcclxuICAgICAgICAgICAgbWF4X3Rva2VuczogbWF4VG9rZW5zIHx8IDIwNDgsXHJcbiAgICAgICAgICAgIHRlbXBlcmF0dXJlOiB0ZW1wZXJhdHVyZSB8fCAwLjdcclxuICAgICAgICAgIH0pXHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgaWYgKCFjb2hlcmVSZXNwb25zZS5vaykge1xyXG4gICAgICAgICAgY29uc3QgZXJyb3IgPSBhd2FpdCBjb2hlcmVSZXNwb25zZS5qc29uKCkuY2F0Y2goKCkgPT4gKHsgbWVzc2FnZTogJ0Vycm9yIGRlc2Nvbm9jaWRvJyB9KSk7XHJcbiAgICAgICAgICBpZiAoY29oZXJlUmVzcG9uc2Uuc3RhdHVzID09PSA0MDEpIHtcclxuICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oJ2FpU2V0dGluZ3MnKTtcclxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdBUEkga2V5IGludsOhbGlkYS4gUG9yIGZhdm9yIHZlcmlmaWNhIHR1IEFQSSBrZXkgZGUgQ29oZXJlIGVuIGxvcyBhanVzdGVzIGRlIHVzdWFyaW8uJyk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEVycm9yIGRlIENvaGVyZTogJHtlcnJvci5tZXNzYWdlIHx8ICdObyBzZSBwdWRvIGdlbmVyYXIgZWwgY29udGVuaWRvJ31gKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgY29uc3QgY29oZXJlRGF0YSA9IGF3YWl0IGNvaGVyZVJlc3BvbnNlLmpzb24oKTtcclxuICAgICAgICByZXR1cm4gY29oZXJlRGF0YS5nZW5lcmF0aW9uc1swXS50ZXh0O1xyXG4gICAgICB9XHJcblxyXG4gICAgICBjYXNlICdtaXN0cmFsJzoge1xyXG4gICAgICAgIGNvbnN0IHNlbGVjdGVkTW9kZWwgPSBtb2RlbCB8fCAnbWlzdHJhbC1sYXJnZS1sYXRlc3QnO1xyXG4gICAgICAgIGNvbnN0IGFwaVVybCA9IGJhc2VVcmwgfHwgJ2h0dHBzOi8vYXBpLm1pc3RyYWwuYWkvdjEvY2hhdC9jb21wbGV0aW9ucyc7XHJcbiAgICAgICAgXHJcbiAgICAgICAgY29uc3QgbWlzdHJhbFJlc3BvbnNlID0gYXdhaXQgZmV0Y2goYXBpVXJsLCB7XHJcbiAgICAgICAgICBtZXRob2Q6ICdQT1NUJyxcclxuICAgICAgICAgIGhlYWRlcnM6IHtcclxuICAgICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyxcclxuICAgICAgICAgICAgJ0F1dGhvcml6YXRpb24nOiBgQmVhcmVyICR7YXBpS2V5fWBcclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgICAgIG1vZGVsOiBzZWxlY3RlZE1vZGVsLFxyXG4gICAgICAgICAgICBtZXNzYWdlczogW3sgcm9sZTogJ3VzZXInLCBjb250ZW50OiBwcm9tcHQgfV0sXHJcbiAgICAgICAgICAgIG1heF90b2tlbnM6IG1heFRva2VucyB8fCAyMDQ4LFxyXG4gICAgICAgICAgICB0ZW1wZXJhdHVyZTogdGVtcGVyYXR1cmUgfHwgMC43XHJcbiAgICAgICAgICB9KVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIFxyXG4gICAgICAgIGlmICghbWlzdHJhbFJlc3BvbnNlLm9rKSB7XHJcbiAgICAgICAgICBjb25zdCBlcnJvciA9IGF3YWl0IG1pc3RyYWxSZXNwb25zZS5qc29uKCkuY2F0Y2goKCkgPT4gKHsgZXJyb3I6IHsgbWVzc2FnZTogJ0Vycm9yIGRlc2Nvbm9jaWRvJyB9IH0pKTtcclxuICAgICAgICAgIGlmIChtaXN0cmFsUmVzcG9uc2Uuc3RhdHVzID09PSA0MDEpIHtcclxuICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oJ2FpU2V0dGluZ3MnKTtcclxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdBUEkga2V5IGludsOhbGlkYS4gUG9yIGZhdm9yIHZlcmlmaWNhIHR1IEFQSSBrZXkgZGUgTWlzdHJhbCBlbiBsb3MgYWp1c3RlcyBkZSB1c3VhcmlvLicpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBFcnJvciBkZSBNaXN0cmFsOiAke2Vycm9yLmVycm9yPy5tZXNzYWdlIHx8ICdObyBzZSBwdWRvIGdlbmVyYXIgZWwgY29udGVuaWRvJ31gKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgY29uc3QgbWlzdHJhbERhdGEgPSBhd2FpdCBtaXN0cmFsUmVzcG9uc2UuanNvbigpO1xyXG4gICAgICAgIHJldHVybiBtaXN0cmFsRGF0YS5jaG9pY2VzWzBdLm1lc3NhZ2UuY29udGVudDtcclxuICAgICAgfVxyXG5cclxuICAgICAgZGVmYXVsdDpcclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1Byb3ZlZWRvciBkZSBJQSBubyBzb3BvcnRhZG8nKTtcclxuICAgIH1cclxuICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBlbiBnZW5lcmF0ZVNjcmlwdFdpdGhBSTonLCBlcnJvcik7XHJcbiAgICBpZiAoZXJyb3IubWVzc2FnZS5pbmNsdWRlcygnQVBJIGtleScpKSB7XHJcbiAgICAgIHRocm93IGVycm9yO1xyXG4gICAgfVxyXG4gICAgdGhyb3cgbmV3IEVycm9yKGBFcnJvciBhbCBjb25lY3RhciBjb24gZWwgc2VydmljaW8gZGUgSUE6ICR7ZXJyb3IubWVzc2FnZX0uIFBvciBmYXZvciB2ZXJpZmljYSB0dSBBUEkga2V5IGUgaW50w6ludGFsbyBkZSBudWV2by5gKTtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBlbmhhbmNlU2VhcmNoV2l0aEFJKHF1ZXJ5OiBzdHJpbmcpOiBQcm9taXNlPHN0cmluZ1tdPiB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IHN0b3JlZFNldHRpbmdzID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ2FpU2V0dGluZ3MnKTtcclxuICAgIGlmICghc3RvcmVkU2V0dGluZ3MpIHtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKCdQYXJhIG9idGVuZXIgc3VnZXJlbmNpYXMgZGUgSUEsIGNvbmZpZ3VyYSB0dXMgYWp1c3RlcyBlbiBlbCBtZW7DuiBkZSB1c3VhcmlvICjDrWNvbm8gZGUgcGVyZmlsIOKGkiBBanVzdGVzKScpO1xyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IHNldHRpbmdzID0gSlNPTi5wYXJzZShzdG9yZWRTZXR0aW5ncyk7XHJcbiAgICBjb25zdCB7IHByb3ZpZGVyLCBhcGlLZXksIG1vZGVsIH0gPSBzZXR0aW5ncztcclxuXHJcbiAgICBpZiAoIXByb3ZpZGVyIHx8ICFhcGlLZXkpIHtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKCdQYXJhIG9idGVuZXIgc3VnZXJlbmNpYXMgZGUgSUEsIGNvbmZpZ3VyYSBlbCBwcm92ZWVkb3IgeSBBUEkga2V5IGVuIGVsIG1lbsO6IGRlIHVzdWFyaW8gKMOtY29ubyBkZSBwZXJmaWwg4oaSIEFqdXN0ZXMpJyk7XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgcHJvbXB0ID0gYEFuYWxpemEgZXN0YSBiw7pzcXVlZGE6IFwiJHtxdWVyeX1cIlxyXG4gICAgMS4gRXh0cmFlIGNvbmNlcHRvcyBjbGF2ZSB5IHTDqXJtaW5vcyByZWxhY2lvbmFkb3NcclxuICAgIDIuIElkZW50aWZpY2Egc2luw7NuaW1vcyB5IHRlbWFzIHJlbGFjaW9uYWRvc1xyXG4gICAgMy4gRGV2dWVsdmUgdW5hIGxpc3RhIGRlIHTDqXJtaW5vcyByZWxldmFudGVzIHBhcmEgbGEgYsO6c3F1ZWRhXHJcbiAgICBGb3JtYXRvOiBsaXN0YSBkZSB0w6lybWlub3Mgc2VwYXJhZG9zIHBvciBjb21hcywgbcOheGltbyA1IHTDqXJtaW5vcy5cclxuICAgIFJlc3B1ZXN0YSBlbiBlc3Bhw7FvbC5gO1xyXG5cclxuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZ2VuZXJhdGVTY3JpcHRXaXRoQUkocHJvbXB0LCBwcm92aWRlciwgYXBpS2V5LCBtb2RlbCk7XHJcbiAgICBjb25zdCB0ZXJtcyA9IHJlc3BvbnNlLnNwbGl0KCcsJylcclxuICAgICAgLm1hcCh0ZXJtID0+IHRlcm0udHJpbSgpKVxyXG4gICAgICAuZmlsdGVyKEJvb2xlYW4pXHJcbiAgICAgIC5zbGljZSgwLCA1KTtcclxuXHJcbiAgICBpZiAodGVybXMubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgIHRocm93IG5ldyBFcnJvcignTm8gc2UgcHVkaWVyb24gZ2VuZXJhciBzdWdlcmVuY2lhcyBwYXJhIGVzdGEgYsO6c3F1ZWRhJyk7XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIHRlcm1zO1xyXG4gIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGFsIG1lam9yYXIgbGEgYsO6c3F1ZWRhOicsIGVycm9yKTtcclxuICAgIHRocm93IGVycm9yO1xyXG4gIH1cclxufSJdLCJuYW1lcyI6WyJnZW5lcmF0ZVNjcmlwdFdpdGhBSSIsInByb21wdCIsInByb3ZpZGVyIiwiYXBpS2V5IiwibW9kZWwiLCJ0ZW1wZXJhdHVyZSIsIm1heFRva2VucyIsImJhc2VVcmwiLCJzdG9yZWRTZXR0aW5ncyIsImxvY2FsU3RvcmFnZSIsImdldEl0ZW0iLCJzZXR0aW5ncyIsIkpTT04iLCJwYXJzZSIsIkVycm9yIiwidHJpbSIsInJlbW92ZUl0ZW0iLCJzZWxlY3RlZE1vZGVsIiwicmVzcG9uc2UiLCJmZXRjaCIsIm1ldGhvZCIsImhlYWRlcnMiLCJib2R5Iiwic3RyaW5naWZ5IiwiY29udGVudHMiLCJwYXJ0cyIsInRleHQiLCJnZW5lcmF0aW9uQ29uZmlnIiwibWF4T3V0cHV0VG9rZW5zIiwib2siLCJlcnJvciIsImpzb24iLCJjYXRjaCIsIm1lc3NhZ2UiLCJzdGF0dXMiLCJkYXRhIiwiY2FuZGlkYXRlcyIsImNvbnRlbnQiLCJvcGVuYWlSZXNwb25zZSIsIm1lc3NhZ2VzIiwicm9sZSIsIm1heF90b2tlbnMiLCJvcGVuYWlEYXRhIiwiY2hvaWNlcyIsImFudGhyb3BpY1Jlc3BvbnNlIiwiYW50aHJvcGljRGF0YSIsImFwaVVybCIsImNvaGVyZVJlc3BvbnNlIiwiY29oZXJlRGF0YSIsImdlbmVyYXRpb25zIiwibWlzdHJhbFJlc3BvbnNlIiwibWlzdHJhbERhdGEiLCJjb25zb2xlIiwiaW5jbHVkZXMiLCJlbmhhbmNlU2VhcmNoV2l0aEFJIiwicXVlcnkiLCJ0ZXJtcyIsInNwbGl0IiwibWFwIiwidGVybSIsImZpbHRlciIsIkJvb2xlYW4iLCJzbGljZSIsImxlbmd0aCJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(ssr)/./src/lib/ai.ts\n");

/***/ })

};
;