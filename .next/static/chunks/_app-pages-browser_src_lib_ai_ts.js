"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(self["webpackChunk_N_E"] = self["webpackChunk_N_E"] || []).push([["_app-pages-browser_src_lib_ai_ts"],{

/***/ "(app-pages-browser)/./src/lib/ai.ts":
/*!***********************!*\
  !*** ./src/lib/ai.ts ***!
  \***********************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   enhanceSearchWithAI: () => (/* binding */ enhanceSearchWithAI),\n/* harmony export */   generateScriptWithAI: () => (/* binding */ generateScriptWithAI)\n/* harmony export */ });\nasync function generateScriptWithAI(prompt, provider, apiKey, model, temperature, maxTokens, baseUrl) {\n    // Get stored AI settings if not provided\n    if (!apiKey || !provider) {\n        const storedSettings = localStorage.getItem('aiSettings');\n        if (storedSettings) {\n            const settings = JSON.parse(storedSettings);\n            provider = provider || settings.provider;\n            apiKey = apiKey || settings.apiKey;\n            model = model || settings.model;\n            temperature = temperature !== null && temperature !== void 0 ? temperature : settings.temperature;\n            maxTokens = maxTokens !== null && maxTokens !== void 0 ? maxTokens : settings.maxTokens;\n            baseUrl = baseUrl || settings.baseUrl;\n        }\n    }\n    if (!provider) {\n        throw new Error('Se requiere seleccionar un proveedor de IA. Por favor configura tus ajustes de IA en el menú de usuario.');\n    }\n    if (!apiKey) {\n        throw new Error('Se requiere una API key. Por favor configura tus ajustes de IA en el menú de usuario.');\n    }\n    // Validate API key format before making request\n    if (typeof apiKey !== 'string' || !apiKey.trim()) {\n        localStorage.removeItem('aiSettings'); // Clear invalid settings\n        throw new Error('API key inválida. Por favor verifica que hayas ingresado una API key válida en los ajustes de usuario.');\n    }\n    // Trim the API key to prevent whitespace issues\n    apiKey = apiKey.trim();\n    try {\n        switch(provider){\n            case 'gemini':\n                {\n                    var _data_candidates__content_parts_, _data_candidates__content_parts, _data_candidates__content, _data_candidates_, _data_candidates;\n                    // Default to gemini-2.0-flash if no model specified\n                    const selectedModel = model || 'gemini-2.0-flash';\n                    const response = await fetch(\"https://generativelanguage.googleapis.com/v1beta/models/\".concat(selectedModel, \":generateContent?key=\").concat(apiKey), {\n                        method: 'POST',\n                        headers: {\n                            'Content-Type': 'application/json'\n                        },\n                        body: JSON.stringify({\n                            contents: [\n                                {\n                                    parts: [\n                                        {\n                                            text: prompt\n                                        }\n                                    ]\n                                }\n                            ],\n                            generationConfig: {\n                                temperature: temperature || 0.7,\n                                maxOutputTokens: maxTokens || 2048\n                            }\n                        })\n                    });\n                    if (!response.ok) {\n                        var _error_error;\n                        const error = await response.json().catch(()=>({\n                                error: {\n                                    message: 'Error desconocido'\n                                }\n                            }));\n                        if (response.status === 401) {\n                            localStorage.removeItem('aiSettings'); // Clear invalid settings\n                            throw new Error(\"La API key de Google AI Studio no es v\\xe1lida para el modelo \".concat(selectedModel, \". Por favor, verifica que la API key tenga los permisos necesarios.\"));\n                        }\n                        throw new Error(\"Error de Gemini: \".concat(((_error_error = error.error) === null || _error_error === void 0 ? void 0 : _error_error.message) || 'No se pudo generar el contenido'));\n                    }\n                    const data = await response.json();\n                    if (!((_data_candidates = data.candidates) === null || _data_candidates === void 0 ? void 0 : (_data_candidates_ = _data_candidates[0]) === null || _data_candidates_ === void 0 ? void 0 : (_data_candidates__content = _data_candidates_.content) === null || _data_candidates__content === void 0 ? void 0 : (_data_candidates__content_parts = _data_candidates__content.parts) === null || _data_candidates__content_parts === void 0 ? void 0 : (_data_candidates__content_parts_ = _data_candidates__content_parts[0]) === null || _data_candidates__content_parts_ === void 0 ? void 0 : _data_candidates__content_parts_.text)) {\n                        throw new Error('No se recibió una respuesta válida del servicio de IA');\n                    }\n                    return data.candidates[0].content.parts[0].text;\n                }\n            case 'openai':\n                {\n                    const selectedModel = model || 'gpt-4o';\n                    const openaiResponse = await fetch('https://api.openai.com/v1/chat/completions', {\n                        method: 'POST',\n                        headers: {\n                            'Content-Type': 'application/json',\n                            'Authorization': \"Bearer \".concat(apiKey)\n                        },\n                        body: JSON.stringify({\n                            model: selectedModel,\n                            messages: [\n                                {\n                                    role: 'user',\n                                    content: prompt\n                                }\n                            ],\n                            temperature: temperature || 0.7,\n                            max_tokens: maxTokens || 2048\n                        })\n                    });\n                    if (!openaiResponse.ok) {\n                        var _error_error1;\n                        const error = await openaiResponse.json().catch(()=>({\n                                error: {\n                                    message: 'Error desconocido'\n                                }\n                            }));\n                        if (openaiResponse.status === 401) {\n                            localStorage.removeItem('aiSettings');\n                            throw new Error('API key inválida. Por favor verifica tu API key de OpenAI en los ajustes de usuario.');\n                        }\n                        throw new Error(\"Error de OpenAI: \".concat(((_error_error1 = error.error) === null || _error_error1 === void 0 ? void 0 : _error_error1.message) || 'No se pudo generar el contenido'));\n                    }\n                    const openaiData = await openaiResponse.json();\n                    return openaiData.choices[0].message.content;\n                }\n            case 'anthropic':\n                {\n                    const selectedModel = model || 'claude-3-5-sonnet-20241022';\n                    const anthropicResponse = await fetch('https://api.anthropic.com/v1/messages', {\n                        method: 'POST',\n                        headers: {\n                            'Content-Type': 'application/json',\n                            'x-api-key': apiKey,\n                            'anthropic-version': '2023-06-01'\n                        },\n                        body: JSON.stringify({\n                            model: selectedModel,\n                            messages: [\n                                {\n                                    role: 'user',\n                                    content: prompt\n                                }\n                            ],\n                            max_tokens: maxTokens || 2048,\n                            temperature: temperature || 0.7\n                        })\n                    });\n                    if (!anthropicResponse.ok) {\n                        var _error_error2;\n                        const error = await anthropicResponse.json().catch(()=>({\n                                error: {\n                                    message: 'Error desconocido'\n                                }\n                            }));\n                        if (anthropicResponse.status === 401) {\n                            localStorage.removeItem('aiSettings');\n                            throw new Error('API key inválida. Por favor verifica tu API key de Anthropic en los ajustes de usuario.');\n                        }\n                        throw new Error(\"Error de Anthropic: \".concat(((_error_error2 = error.error) === null || _error_error2 === void 0 ? void 0 : _error_error2.message) || 'No se pudo generar el contenido'));\n                    }\n                    const anthropicData = await anthropicResponse.json();\n                    return anthropicData.content[0].text;\n                }\n            case 'cohere':\n                {\n                    const selectedModel = model || 'command-r-plus';\n                    const apiUrl = baseUrl || 'https://api.cohere.ai/v1/generate';\n                    const cohereResponse = await fetch(apiUrl, {\n                        method: 'POST',\n                        headers: {\n                            'Content-Type': 'application/json',\n                            'Authorization': \"Bearer \".concat(apiKey)\n                        },\n                        body: JSON.stringify({\n                            model: selectedModel,\n                            prompt: prompt,\n                            max_tokens: maxTokens || 2048,\n                            temperature: temperature || 0.7\n                        })\n                    });\n                    if (!cohereResponse.ok) {\n                        const error = await cohereResponse.json().catch(()=>({\n                                message: 'Error desconocido'\n                            }));\n                        if (cohereResponse.status === 401) {\n                            localStorage.removeItem('aiSettings');\n                            throw new Error('API key inválida. Por favor verifica tu API key de Cohere en los ajustes de usuario.');\n                        }\n                        throw new Error(\"Error de Cohere: \".concat(error.message || 'No se pudo generar el contenido'));\n                    }\n                    const cohereData = await cohereResponse.json();\n                    return cohereData.generations[0].text;\n                }\n            case 'mistral':\n                {\n                    const selectedModel = model || 'mistral-large-latest';\n                    const apiUrl = baseUrl || 'https://api.mistral.ai/v1/chat/completions';\n                    const mistralResponse = await fetch(apiUrl, {\n                        method: 'POST',\n                        headers: {\n                            'Content-Type': 'application/json',\n                            'Authorization': \"Bearer \".concat(apiKey)\n                        },\n                        body: JSON.stringify({\n                            model: selectedModel,\n                            messages: [\n                                {\n                                    role: 'user',\n                                    content: prompt\n                                }\n                            ],\n                            max_tokens: maxTokens || 2048,\n                            temperature: temperature || 0.7\n                        })\n                    });\n                    if (!mistralResponse.ok) {\n                        var _error_error3;\n                        const error = await mistralResponse.json().catch(()=>({\n                                error: {\n                                    message: 'Error desconocido'\n                                }\n                            }));\n                        if (mistralResponse.status === 401) {\n                            localStorage.removeItem('aiSettings');\n                            throw new Error('API key inválida. Por favor verifica tu API key de Mistral en los ajustes de usuario.');\n                        }\n                        throw new Error(\"Error de Mistral: \".concat(((_error_error3 = error.error) === null || _error_error3 === void 0 ? void 0 : _error_error3.message) || 'No se pudo generar el contenido'));\n                    }\n                    const mistralData = await mistralResponse.json();\n                    return mistralData.choices[0].message.content;\n                }\n            default:\n                throw new Error('Proveedor de IA no soportado');\n        }\n    } catch (error) {\n        console.error('Error en generateScriptWithAI:', error);\n        if (error.message.includes('API key')) {\n            throw error;\n        }\n        throw new Error(\"Error al conectar con el servicio de IA: \".concat(error.message, \". Por favor verifica tu API key e int\\xe9ntalo de nuevo.\"));\n    }\n}\nasync function enhanceSearchWithAI(query) {\n    try {\n        const storedSettings = localStorage.getItem('aiSettings');\n        if (!storedSettings) {\n            throw new Error('Para obtener sugerencias de IA, configura tus ajustes en el menú de usuario (ícono de perfil → Ajustes)');\n        }\n        const settings = JSON.parse(storedSettings);\n        const { provider, apiKey, model } = settings;\n        if (!provider || !apiKey) {\n            throw new Error('Para obtener sugerencias de IA, configura el proveedor y API key en el menú de usuario (ícono de perfil → Ajustes)');\n        }\n        const prompt = 'Analiza esta b\\xfasqueda: \"'.concat(query, '\"\\n    1. Extrae conceptos clave y t\\xe9rminos relacionados\\n    2. Identifica sin\\xf3nimos y temas relacionados\\n    3. Devuelve una lista de t\\xe9rminos relevantes para la b\\xfasqueda\\n    Formato: lista de t\\xe9rminos separados por comas, m\\xe1ximo 5 t\\xe9rminos.\\n    Respuesta en espa\\xf1ol.');\n        const response = await generateScriptWithAI(prompt, provider, apiKey, model);\n        const terms = response.split(',').map((term)=>term.trim()).filter(Boolean).slice(0, 5);\n        if (terms.length === 0) {\n            throw new Error('No se pudieron generar sugerencias para esta búsqueda');\n        }\n        return terms;\n    } catch (error) {\n        console.error('Error al mejorar la búsqueda:', error);\n        throw error;\n    }\n}\n\n\n;\n    // Wrapped in an IIFE to avoid polluting the global scope\n    ;\n    (function () {\n        var _a, _b;\n        // Legacy CSS implementations will `eval` browser code in a Node.js context\n        // to extract CSS. For backwards compatibility, we need to check we're in a\n        // browser context before continuing.\n        if (typeof self !== 'undefined' &&\n            // AMP / No-JS mode does not inject these helpers:\n            '$RefreshHelpers$' in self) {\n            // @ts-ignore __webpack_module__ is global\n            var currentExports = module.exports;\n            // @ts-ignore __webpack_module__ is global\n            var prevSignature = (_b = (_a = module.hot.data) === null || _a === void 0 ? void 0 : _a.prevSignature) !== null && _b !== void 0 ? _b : null;\n            // This cannot happen in MainTemplate because the exports mismatch between\n            // templating and execution.\n            self.$RefreshHelpers$.registerExportsForReactRefresh(currentExports, module.id);\n            // A module can be accepted automatically based on its exports, e.g. when\n            // it is a Refresh Boundary.\n            if (self.$RefreshHelpers$.isReactRefreshBoundary(currentExports)) {\n                // Save the previous exports signature on update so we can compare the boundary\n                // signatures. We avoid saving exports themselves since it causes memory leaks (https://github.com/vercel/next.js/pull/53797)\n                module.hot.dispose(function (data) {\n                    data.prevSignature =\n                        self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports);\n                });\n                // Unconditionally accept an update to this module, we'll check if it's\n                // still a Refresh Boundary later.\n                // @ts-ignore importMeta is replaced in the loader\n                module.hot.accept();\n                // This field is set when the previous version of this module was a\n                // Refresh Boundary, letting us know we need to check for invalidation or\n                // enqueue an update.\n                if (prevSignature !== null) {\n                    // A boundary can become ineligible if its exports are incompatible\n                    // with the previous exports.\n                    //\n                    // For example, if you add/remove/change exports, we'll want to\n                    // re-execute the importing modules, and force those components to\n                    // re-render. Similarly, if you convert a class component to a\n                    // function, we want to invalidate the boundary.\n                    if (self.$RefreshHelpers$.shouldInvalidateReactRefreshBoundary(prevSignature, self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports))) {\n                        module.hot.invalidate();\n                    }\n                    else {\n                        self.$RefreshHelpers$.scheduleUpdate();\n                    }\n                }\n            }\n            else {\n                // Since we just executed the code for the module, it's possible that the\n                // new exports made it ineligible for being a boundary.\n                // We only care about the case when we were _previously_ a boundary,\n                // because we already accepted this update (accidental side effect).\n                var isNoLongerABoundary = prevSignature !== null;\n                if (isNoLongerABoundary) {\n                    module.hot.invalidate();\n                }\n            }\n        }\n    })();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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T0FBUUEsS0FBSzVDLElBQUksSUFDckI2QyxNQUFNLENBQUNDLFNBQ1BDLEtBQUssQ0FBQyxHQUFHO1FBRVosSUFBSU4sTUFBTU8sTUFBTSxLQUFLLEdBQUc7WUFDdEIsTUFBTSxJQUFJakQsTUFBTTtRQUNsQjtRQUVBLE9BQU8wQztJQUNULEVBQUUsT0FBT3pCLE9BQVk7UUFDbkJxQixRQUFRckIsS0FBSyxDQUFDLGlDQUFpQ0E7UUFDL0MsTUFBTUE7SUFDUjtBQUNGIiwic291cmNlcyI6WyJDOlxcVXNlcnNcXHByb2dyYW1hclxcRG9jdW1lbnRzXFxHaXRIdWJcXHJlZGNyZWF0aXZhcHJvXFxzcmNcXGxpYlxcYWkudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQUlQcm92aWRlciwgQUlNb2RlbCwgQUlTZXR0aW5ncyB9IGZyb20gJ0AvdHlwZXMvYWknO1xyXG5cclxuXHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2VuZXJhdGVTY3JpcHRXaXRoQUkoXHJcbiAgcHJvbXB0OiBzdHJpbmcsIFxyXG4gIHByb3ZpZGVyPzogQUlQcm92aWRlciwgXHJcbiAgYXBpS2V5Pzogc3RyaW5nLFxyXG4gIG1vZGVsPzogQUlNb2RlbCxcclxuICB0ZW1wZXJhdHVyZT86IG51bWJlcixcclxuICBtYXhUb2tlbnM/OiBudW1iZXIsXHJcbiAgYmFzZVVybD86IHN0cmluZ1xyXG4pOiBQcm9taXNlPHN0cmluZz4ge1xyXG4gIFxyXG4gIC8vIEdldCBzdG9yZWQgQUkgc2V0dGluZ3MgaWYgbm90IHByb3ZpZGVkXHJcbiAgaWYgKCFhcGlLZXkgfHwgIXByb3ZpZGVyKSB7XHJcbiAgICBjb25zdCBzdG9yZWRTZXR0aW5ncyA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdhaVNldHRpbmdzJyk7XHJcbiAgICBpZiAoc3RvcmVkU2V0dGluZ3MpIHtcclxuICAgICAgY29uc3Qgc2V0dGluZ3M6IEFJU2V0dGluZ3MgPSBKU09OLnBhcnNlKHN0b3JlZFNldHRpbmdzKTtcclxuICAgICAgcHJvdmlkZXIgPSBwcm92aWRlciB8fCBzZXR0aW5ncy5wcm92aWRlcjtcclxuICAgICAgYXBpS2V5ID0gYXBpS2V5IHx8IHNldHRpbmdzLmFwaUtleTtcclxuICAgICAgbW9kZWwgPSBtb2RlbCB8fCBzZXR0aW5ncy5tb2RlbDtcclxuICAgICAgdGVtcGVyYXR1cmUgPSB0ZW1wZXJhdHVyZSA/PyBzZXR0aW5ncy50ZW1wZXJhdHVyZTtcclxuICAgICAgbWF4VG9rZW5zID0gbWF4VG9rZW5zID8/IHNldHRpbmdzLm1heFRva2VucztcclxuICAgICAgYmFzZVVybCA9IGJhc2VVcmwgfHwgc2V0dGluZ3MuYmFzZVVybDtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIGlmICghcHJvdmlkZXIpIHtcclxuICAgIHRocm93IG5ldyBFcnJvcignU2UgcmVxdWllcmUgc2VsZWNjaW9uYXIgdW4gcHJvdmVlZG9yIGRlIElBLiBQb3IgZmF2b3IgY29uZmlndXJhIHR1cyBhanVzdGVzIGRlIElBIGVuIGVsIG1lbsO6IGRlIHVzdWFyaW8uJyk7XHJcbiAgfVxyXG5cclxuICBpZiAoIWFwaUtleSkge1xyXG4gICAgdGhyb3cgbmV3IEVycm9yKCdTZSByZXF1aWVyZSB1bmEgQVBJIGtleS4gUG9yIGZhdm9yIGNvbmZpZ3VyYSB0dXMgYWp1c3RlcyBkZSBJQSBlbiBlbCBtZW7DuiBkZSB1c3VhcmlvLicpO1xyXG4gIH1cclxuXHJcbiAgLy8gVmFsaWRhdGUgQVBJIGtleSBmb3JtYXQgYmVmb3JlIG1ha2luZyByZXF1ZXN0XHJcbiAgaWYgKHR5cGVvZiBhcGlLZXkgIT09ICdzdHJpbmcnIHx8ICFhcGlLZXkudHJpbSgpKSB7XHJcbiAgICBsb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbSgnYWlTZXR0aW5ncycpOyAvLyBDbGVhciBpbnZhbGlkIHNldHRpbmdzXHJcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ0FQSSBrZXkgaW52w6FsaWRhLiBQb3IgZmF2b3IgdmVyaWZpY2EgcXVlIGhheWFzIGluZ3Jlc2FkbyB1bmEgQVBJIGtleSB2w6FsaWRhIGVuIGxvcyBhanVzdGVzIGRlIHVzdWFyaW8uJyk7XHJcbiAgfVxyXG5cclxuICAvLyBUcmltIHRoZSBBUEkga2V5IHRvIHByZXZlbnQgd2hpdGVzcGFjZSBpc3N1ZXNcclxuICBhcGlLZXkgPSBhcGlLZXkudHJpbSgpO1xyXG5cclxuICB0cnkge1xyXG4gICAgc3dpdGNoIChwcm92aWRlcikge1xyXG4gICAgICBjYXNlICdnZW1pbmknOiB7XHJcbiAgICAgICAgLy8gRGVmYXVsdCB0byBnZW1pbmktMi4wLWZsYXNoIGlmIG5vIG1vZGVsIHNwZWNpZmllZFxyXG4gICAgICAgIGNvbnN0IHNlbGVjdGVkTW9kZWwgPSBtb2RlbCB8fCAnZ2VtaW5pLTIuMC1mbGFzaCc7XHJcbiAgICAgICAgXHJcbiAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChgaHR0cHM6Ly9nZW5lcmF0aXZlbGFuZ3VhZ2UuZ29vZ2xlYXBpcy5jb20vdjFiZXRhL21vZGVscy8ke3NlbGVjdGVkTW9kZWx9OmdlbmVyYXRlQ29udGVudD9rZXk9JHthcGlLZXl9YCwge1xyXG4gICAgICAgICAgbWV0aG9kOiAnUE9TVCcsXHJcbiAgICAgICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbidcclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgICAgIGNvbnRlbnRzOiBbXHJcbiAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgcGFydHM6IFtcclxuICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIHRleHQ6IHByb21wdFxyXG4gICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBdXHJcbiAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBdLFxyXG4gICAgICAgICAgICBnZW5lcmF0aW9uQ29uZmlnOiB7XHJcbiAgICAgICAgICAgICAgdGVtcGVyYXR1cmU6IHRlbXBlcmF0dXJlIHx8IDAuNyxcclxuICAgICAgICAgICAgICBtYXhPdXRwdXRUb2tlbnM6IG1heFRva2VucyB8fCAyMDQ4XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH0pXHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgaWYgKCFyZXNwb25zZS5vaykge1xyXG4gICAgICAgICAgY29uc3QgZXJyb3IgPSBhd2FpdCByZXNwb25zZS5qc29uKCkuY2F0Y2goKCkgPT4gKHsgZXJyb3I6IHsgbWVzc2FnZTogJ0Vycm9yIGRlc2Nvbm9jaWRvJyB9IH0pKTtcclxuICAgICAgICAgIGlmIChyZXNwb25zZS5zdGF0dXMgPT09IDQwMSkge1xyXG4gICAgICAgICAgICBsb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbSgnYWlTZXR0aW5ncycpOyAvLyBDbGVhciBpbnZhbGlkIHNldHRpbmdzXHJcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgTGEgQVBJIGtleSBkZSBHb29nbGUgQUkgU3R1ZGlvIG5vIGVzIHbDoWxpZGEgcGFyYSBlbCBtb2RlbG8gJHtzZWxlY3RlZE1vZGVsfS4gUG9yIGZhdm9yLCB2ZXJpZmljYSBxdWUgbGEgQVBJIGtleSB0ZW5nYSBsb3MgcGVybWlzb3MgbmVjZXNhcmlvcy5gKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgRXJyb3IgZGUgR2VtaW5pOiAke2Vycm9yLmVycm9yPy5tZXNzYWdlIHx8ICdObyBzZSBwdWRvIGdlbmVyYXIgZWwgY29udGVuaWRvJ31gKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgY29uc3QgZGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcclxuICAgICAgICBpZiAoIWRhdGEuY2FuZGlkYXRlcz8uWzBdPy5jb250ZW50Py5wYXJ0cz8uWzBdPy50ZXh0KSB7XHJcbiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ05vIHNlIHJlY2liacOzIHVuYSByZXNwdWVzdGEgdsOhbGlkYSBkZWwgc2VydmljaW8gZGUgSUEnKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGRhdGEuY2FuZGlkYXRlc1swXS5jb250ZW50LnBhcnRzWzBdLnRleHQ7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGNhc2UgJ29wZW5haSc6IHtcclxuICAgICAgICBjb25zdCBzZWxlY3RlZE1vZGVsID0gbW9kZWwgfHwgJ2dwdC00byc7XHJcbiAgICAgICAgY29uc3Qgb3BlbmFpUmVzcG9uc2UgPSBhd2FpdCBmZXRjaCgnaHR0cHM6Ly9hcGkub3BlbmFpLmNvbS92MS9jaGF0L2NvbXBsZXRpb25zJywge1xyXG4gICAgICAgICAgbWV0aG9kOiAnUE9TVCcsXHJcbiAgICAgICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXHJcbiAgICAgICAgICAgICdBdXRob3JpemF0aW9uJzogYEJlYXJlciAke2FwaUtleX1gXHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgICAgICBtb2RlbDogc2VsZWN0ZWRNb2RlbCxcclxuICAgICAgICAgICAgbWVzc2FnZXM6IFt7IHJvbGU6ICd1c2VyJywgY29udGVudDogcHJvbXB0IH1dLFxyXG4gICAgICAgICAgICB0ZW1wZXJhdHVyZTogdGVtcGVyYXR1cmUgfHwgMC43LFxyXG4gICAgICAgICAgICBtYXhfdG9rZW5zOiBtYXhUb2tlbnMgfHwgMjA0OFxyXG4gICAgICAgICAgfSlcclxuICAgICAgICB9KTtcclxuICAgICAgICBcclxuICAgICAgICBpZiAoIW9wZW5haVJlc3BvbnNlLm9rKSB7XHJcbiAgICAgICAgICBjb25zdCBlcnJvciA9IGF3YWl0IG9wZW5haVJlc3BvbnNlLmpzb24oKS5jYXRjaCgoKSA9PiAoeyBlcnJvcjogeyBtZXNzYWdlOiAnRXJyb3IgZGVzY29ub2NpZG8nIH0gfSkpO1xyXG4gICAgICAgICAgaWYgKG9wZW5haVJlc3BvbnNlLnN0YXR1cyA9PT0gNDAxKSB7XHJcbiAgICAgICAgICAgIGxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKCdhaVNldHRpbmdzJyk7XHJcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignQVBJIGtleSBpbnbDoWxpZGEuIFBvciBmYXZvciB2ZXJpZmljYSB0dSBBUEkga2V5IGRlIE9wZW5BSSBlbiBsb3MgYWp1c3RlcyBkZSB1c3VhcmlvLicpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBFcnJvciBkZSBPcGVuQUk6ICR7ZXJyb3IuZXJyb3I/Lm1lc3NhZ2UgfHwgJ05vIHNlIHB1ZG8gZ2VuZXJhciBlbCBjb250ZW5pZG8nfWApO1xyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgICAgICBjb25zdCBvcGVuYWlEYXRhID0gYXdhaXQgb3BlbmFpUmVzcG9uc2UuanNvbigpO1xyXG4gICAgICAgIHJldHVybiBvcGVuYWlEYXRhLmNob2ljZXNbMF0ubWVzc2FnZS5jb250ZW50O1xyXG4gICAgICB9XHJcblxyXG4gICAgICBjYXNlICdhbnRocm9waWMnOiB7XHJcbiAgICAgICAgY29uc3Qgc2VsZWN0ZWRNb2RlbCA9IG1vZGVsIHx8ICdjbGF1ZGUtMy01LXNvbm5ldC0yMDI0MTAyMic7XHJcbiAgICAgICAgY29uc3QgYW50aHJvcGljUmVzcG9uc2UgPSBhd2FpdCBmZXRjaCgnaHR0cHM6Ly9hcGkuYW50aHJvcGljLmNvbS92MS9tZXNzYWdlcycsIHtcclxuICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxyXG4gICAgICAgICAgaGVhZGVyczoge1xyXG4gICAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxyXG4gICAgICAgICAgICAneC1hcGkta2V5JzogYXBpS2V5LFxyXG4gICAgICAgICAgICAnYW50aHJvcGljLXZlcnNpb24nOiAnMjAyMy0wNi0wMSdcclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgICAgIG1vZGVsOiBzZWxlY3RlZE1vZGVsLFxyXG4gICAgICAgICAgICBtZXNzYWdlczogW3sgcm9sZTogJ3VzZXInLCBjb250ZW50OiBwcm9tcHQgfV0sXHJcbiAgICAgICAgICAgIG1heF90b2tlbnM6IG1heFRva2VucyB8fCAyMDQ4LFxyXG4gICAgICAgICAgICB0ZW1wZXJhdHVyZTogdGVtcGVyYXR1cmUgfHwgMC43XHJcbiAgICAgICAgICB9KVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIFxyXG4gICAgICAgIGlmICghYW50aHJvcGljUmVzcG9uc2Uub2spIHtcclxuICAgICAgICAgIGNvbnN0IGVycm9yID0gYXdhaXQgYW50aHJvcGljUmVzcG9uc2UuanNvbigpLmNhdGNoKCgpID0+ICh7IGVycm9yOiB7IG1lc3NhZ2U6ICdFcnJvciBkZXNjb25vY2lkbycgfSB9KSk7XHJcbiAgICAgICAgICBpZiAoYW50aHJvcGljUmVzcG9uc2Uuc3RhdHVzID09PSA0MDEpIHtcclxuICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oJ2FpU2V0dGluZ3MnKTtcclxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdBUEkga2V5IGludsOhbGlkYS4gUG9yIGZhdm9yIHZlcmlmaWNhIHR1IEFQSSBrZXkgZGUgQW50aHJvcGljIGVuIGxvcyBhanVzdGVzIGRlIHVzdWFyaW8uJyk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEVycm9yIGRlIEFudGhyb3BpYzogJHtlcnJvci5lcnJvcj8ubWVzc2FnZSB8fCAnTm8gc2UgcHVkbyBnZW5lcmFyIGVsIGNvbnRlbmlkbyd9YCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgICAgIGNvbnN0IGFudGhyb3BpY0RhdGEgPSBhd2FpdCBhbnRocm9waWNSZXNwb25zZS5qc29uKCk7XHJcbiAgICAgICAgcmV0dXJuIGFudGhyb3BpY0RhdGEuY29udGVudFswXS50ZXh0O1xyXG4gICAgICB9XHJcblxyXG4gICAgICBjYXNlICdjb2hlcmUnOiB7XHJcbiAgICAgICAgY29uc3Qgc2VsZWN0ZWRNb2RlbCA9IG1vZGVsIHx8ICdjb21tYW5kLXItcGx1cyc7XHJcbiAgICAgICAgY29uc3QgYXBpVXJsID0gYmFzZVVybCB8fCAnaHR0cHM6Ly9hcGkuY29oZXJlLmFpL3YxL2dlbmVyYXRlJztcclxuICAgICAgICBcclxuICAgICAgICBjb25zdCBjb2hlcmVSZXNwb25zZSA9IGF3YWl0IGZldGNoKGFwaVVybCwge1xyXG4gICAgICAgICAgbWV0aG9kOiAnUE9TVCcsXHJcbiAgICAgICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXHJcbiAgICAgICAgICAgICdBdXRob3JpemF0aW9uJzogYEJlYXJlciAke2FwaUtleX1gXHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgICAgICBtb2RlbDogc2VsZWN0ZWRNb2RlbCxcclxuICAgICAgICAgICAgcHJvbXB0OiBwcm9tcHQsXHJcbiAgICAgICAgICAgIG1heF90b2tlbnM6IG1heFRva2VucyB8fCAyMDQ4LFxyXG4gICAgICAgICAgICB0ZW1wZXJhdHVyZTogdGVtcGVyYXR1cmUgfHwgMC43XHJcbiAgICAgICAgICB9KVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIFxyXG4gICAgICAgIGlmICghY29oZXJlUmVzcG9uc2Uub2spIHtcclxuICAgICAgICAgIGNvbnN0IGVycm9yID0gYXdhaXQgY29oZXJlUmVzcG9uc2UuanNvbigpLmNhdGNoKCgpID0+ICh7IG1lc3NhZ2U6ICdFcnJvciBkZXNjb25vY2lkbycgfSkpO1xyXG4gICAgICAgICAgaWYgKGNvaGVyZVJlc3BvbnNlLnN0YXR1cyA9PT0gNDAxKSB7XHJcbiAgICAgICAgICAgIGxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKCdhaVNldHRpbmdzJyk7XHJcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignQVBJIGtleSBpbnbDoWxpZGEuIFBvciBmYXZvciB2ZXJpZmljYSB0dSBBUEkga2V5IGRlIENvaGVyZSBlbiBsb3MgYWp1c3RlcyBkZSB1c3VhcmlvLicpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBFcnJvciBkZSBDb2hlcmU6ICR7ZXJyb3IubWVzc2FnZSB8fCAnTm8gc2UgcHVkbyBnZW5lcmFyIGVsIGNvbnRlbmlkbyd9YCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgICAgIGNvbnN0IGNvaGVyZURhdGEgPSBhd2FpdCBjb2hlcmVSZXNwb25zZS5qc29uKCk7XHJcbiAgICAgICAgcmV0dXJuIGNvaGVyZURhdGEuZ2VuZXJhdGlvbnNbMF0udGV4dDtcclxuICAgICAgfVxyXG5cclxuICAgICAgY2FzZSAnbWlzdHJhbCc6IHtcclxuICAgICAgICBjb25zdCBzZWxlY3RlZE1vZGVsID0gbW9kZWwgfHwgJ21pc3RyYWwtbGFyZ2UtbGF0ZXN0JztcclxuICAgICAgICBjb25zdCBhcGlVcmwgPSBiYXNlVXJsIHx8ICdodHRwczovL2FwaS5taXN0cmFsLmFpL3YxL2NoYXQvY29tcGxldGlvbnMnO1xyXG4gICAgICAgIFxyXG4gICAgICAgIGNvbnN0IG1pc3RyYWxSZXNwb25zZSA9IGF3YWl0IGZldGNoKGFwaVVybCwge1xyXG4gICAgICAgICAgbWV0aG9kOiAnUE9TVCcsXHJcbiAgICAgICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXHJcbiAgICAgICAgICAgICdBdXRob3JpemF0aW9uJzogYEJlYXJlciAke2FwaUtleX1gXHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgICAgICBtb2RlbDogc2VsZWN0ZWRNb2RlbCxcclxuICAgICAgICAgICAgbWVzc2FnZXM6IFt7IHJvbGU6ICd1c2VyJywgY29udGVudDogcHJvbXB0IH1dLFxyXG4gICAgICAgICAgICBtYXhfdG9rZW5zOiBtYXhUb2tlbnMgfHwgMjA0OCxcclxuICAgICAgICAgICAgdGVtcGVyYXR1cmU6IHRlbXBlcmF0dXJlIHx8IDAuN1xyXG4gICAgICAgICAgfSlcclxuICAgICAgICB9KTtcclxuICAgICAgICBcclxuICAgICAgICBpZiAoIW1pc3RyYWxSZXNwb25zZS5vaykge1xyXG4gICAgICAgICAgY29uc3QgZXJyb3IgPSBhd2FpdCBtaXN0cmFsUmVzcG9uc2UuanNvbigpLmNhdGNoKCgpID0+ICh7IGVycm9yOiB7IG1lc3NhZ2U6ICdFcnJvciBkZXNjb25vY2lkbycgfSB9KSk7XHJcbiAgICAgICAgICBpZiAobWlzdHJhbFJlc3BvbnNlLnN0YXR1cyA9PT0gNDAxKSB7XHJcbiAgICAgICAgICAgIGxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKCdhaVNldHRpbmdzJyk7XHJcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignQVBJIGtleSBpbnbDoWxpZGEuIFBvciBmYXZvciB2ZXJpZmljYSB0dSBBUEkga2V5IGRlIE1pc3RyYWwgZW4gbG9zIGFqdXN0ZXMgZGUgdXN1YXJpby4nKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgRXJyb3IgZGUgTWlzdHJhbDogJHtlcnJvci5lcnJvcj8ubWVzc2FnZSB8fCAnTm8gc2UgcHVkbyBnZW5lcmFyIGVsIGNvbnRlbmlkbyd9YCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgICAgIGNvbnN0IG1pc3RyYWxEYXRhID0gYXdhaXQgbWlzdHJhbFJlc3BvbnNlLmpzb24oKTtcclxuICAgICAgICByZXR1cm4gbWlzdHJhbERhdGEuY2hvaWNlc1swXS5tZXNzYWdlLmNvbnRlbnQ7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdQcm92ZWVkb3IgZGUgSUEgbm8gc29wb3J0YWRvJyk7XHJcbiAgICB9XHJcbiAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgZW4gZ2VuZXJhdGVTY3JpcHRXaXRoQUk6JywgZXJyb3IpO1xyXG4gICAgaWYgKGVycm9yLm1lc3NhZ2UuaW5jbHVkZXMoJ0FQSSBrZXknKSkge1xyXG4gICAgICB0aHJvdyBlcnJvcjtcclxuICAgIH1cclxuICAgIHRocm93IG5ldyBFcnJvcihgRXJyb3IgYWwgY29uZWN0YXIgY29uIGVsIHNlcnZpY2lvIGRlIElBOiAke2Vycm9yLm1lc3NhZ2V9LiBQb3IgZmF2b3IgdmVyaWZpY2EgdHUgQVBJIGtleSBlIGludMOpbnRhbG8gZGUgbnVldm8uYCk7XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZW5oYW5jZVNlYXJjaFdpdGhBSShxdWVyeTogc3RyaW5nKTogUHJvbWlzZTxzdHJpbmdbXT4ge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCBzdG9yZWRTZXR0aW5ncyA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdhaVNldHRpbmdzJyk7XHJcbiAgICBpZiAoIXN0b3JlZFNldHRpbmdzKSB7XHJcbiAgICAgIHRocm93IG5ldyBFcnJvcignUGFyYSBvYnRlbmVyIHN1Z2VyZW5jaWFzIGRlIElBLCBjb25maWd1cmEgdHVzIGFqdXN0ZXMgZW4gZWwgbWVuw7ogZGUgdXN1YXJpbyAow61jb25vIGRlIHBlcmZpbCDihpIgQWp1c3RlcyknKTtcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBzZXR0aW5ncyA9IEpTT04ucGFyc2Uoc3RvcmVkU2V0dGluZ3MpO1xyXG4gICAgY29uc3QgeyBwcm92aWRlciwgYXBpS2V5LCBtb2RlbCB9ID0gc2V0dGluZ3M7XHJcblxyXG4gICAgaWYgKCFwcm92aWRlciB8fCAhYXBpS2V5KSB7XHJcbiAgICAgIHRocm93IG5ldyBFcnJvcignUGFyYSBvYnRlbmVyIHN1Z2VyZW5jaWFzIGRlIElBLCBjb25maWd1cmEgZWwgcHJvdmVlZG9yIHkgQVBJIGtleSBlbiBlbCBtZW7DuiBkZSB1c3VhcmlvICjDrWNvbm8gZGUgcGVyZmlsIOKGkiBBanVzdGVzKScpO1xyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IHByb21wdCA9IGBBbmFsaXphIGVzdGEgYsO6c3F1ZWRhOiBcIiR7cXVlcnl9XCJcclxuICAgIDEuIEV4dHJhZSBjb25jZXB0b3MgY2xhdmUgeSB0w6lybWlub3MgcmVsYWNpb25hZG9zXHJcbiAgICAyLiBJZGVudGlmaWNhIHNpbsOzbmltb3MgeSB0ZW1hcyByZWxhY2lvbmFkb3NcclxuICAgIDMuIERldnVlbHZlIHVuYSBsaXN0YSBkZSB0w6lybWlub3MgcmVsZXZhbnRlcyBwYXJhIGxhIGLDunNxdWVkYVxyXG4gICAgRm9ybWF0bzogbGlzdGEgZGUgdMOpcm1pbm9zIHNlcGFyYWRvcyBwb3IgY29tYXMsIG3DoXhpbW8gNSB0w6lybWlub3MuXHJcbiAgICBSZXNwdWVzdGEgZW4gZXNwYcOxb2wuYDtcclxuXHJcbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGdlbmVyYXRlU2NyaXB0V2l0aEFJKHByb21wdCwgcHJvdmlkZXIsIGFwaUtleSwgbW9kZWwpO1xyXG4gICAgY29uc3QgdGVybXMgPSByZXNwb25zZS5zcGxpdCgnLCcpXHJcbiAgICAgIC5tYXAodGVybSA9PiB0ZXJtLnRyaW0oKSlcclxuICAgICAgLmZpbHRlcihCb29sZWFuKVxyXG4gICAgICAuc2xpY2UoMCwgNSk7XHJcblxyXG4gICAgaWYgKHRlcm1zLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ05vIHNlIHB1ZGllcm9uIGdlbmVyYXIgc3VnZXJlbmNpYXMgcGFyYSBlc3RhIGLDunNxdWVkYScpO1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiB0ZXJtcztcclxuICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBhbCBtZWpvcmFyIGxhIGLDunNxdWVkYTonLCBlcnJvcik7XHJcbiAgICB0aHJvdyBlcnJvcjtcclxuICB9XHJcbn0iXSwibmFtZXMiOlsiZ2VuZXJhdGVTY3JpcHRXaXRoQUkiLCJwcm9tcHQiLCJwcm92aWRlciIsImFwaUtleSIsIm1vZGVsIiwidGVtcGVyYXR1cmUiLCJtYXhUb2tlbnMiLCJiYXNlVXJsIiwic3RvcmVkU2V0dGluZ3MiLCJsb2NhbFN0b3JhZ2UiLCJnZXRJdGVtIiwic2V0dGluZ3MiLCJKU09OIiwicGFyc2UiLCJFcnJvciIsInRyaW0iLCJyZW1vdmVJdGVtIiwiZGF0YSIsInNlbGVjdGVkTW9kZWwiLCJyZXNwb25zZSIsImZldGNoIiwibWV0aG9kIiwiaGVhZGVycyIsImJvZHkiLCJzdHJpbmdpZnkiLCJjb250ZW50cyIsInBhcnRzIiwidGV4dCIsImdlbmVyYXRpb25Db25maWciLCJtYXhPdXRwdXRUb2tlbnMiLCJvayIsImVycm9yIiwianNvbiIsImNhdGNoIiwibWVzc2FnZSIsInN0YXR1cyIsImNhbmRpZGF0ZXMiLCJjb250ZW50Iiwib3BlbmFpUmVzcG9uc2UiLCJtZXNzYWdlcyIsInJvbGUiLCJtYXhfdG9rZW5zIiwib3BlbmFpRGF0YSIsImNob2ljZXMiLCJhbnRocm9waWNSZXNwb25zZSIsImFudGhyb3BpY0RhdGEiLCJhcGlVcmwiLCJjb2hlcmVSZXNwb25zZSIsImNvaGVyZURhdGEiLCJnZW5lcmF0aW9ucyIsIm1pc3RyYWxSZXNwb25zZSIsIm1pc3RyYWxEYXRhIiwiY29uc29sZSIsImluY2x1ZGVzIiwiZW5oYW5jZVNlYXJjaFdpdGhBSSIsInF1ZXJ5IiwidGVybXMiLCJzcGxpdCIsIm1hcCIsInRlcm0iLCJmaWx0ZXIiLCJCb29sZWFuIiwic2xpY2UiLCJsZW5ndGgiXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(app-pages-browser)/./src/lib/ai.ts\n"));

/***/ })

}]);